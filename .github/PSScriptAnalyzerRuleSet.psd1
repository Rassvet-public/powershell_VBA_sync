# PSScriptAnalyzer RuleSet
# Набор A — строгие и полезные правила, влияющие на корректность работы скриптов.
# Оформление, стиль и косметические предупреждения в этот набор НЕ включены.

@{
    Severity = @("Error")   # Мы включаем только критичные и важные предупреждения.
    Rules = @{

        ###########################################################################
        # 🔥 PSAvoidAssignmentToAutomaticVariable
        # Запрещает присваивать значения встроенным переменным PowerShell,
        # таким как $null, $true, $false, $args, $PSItem.
        # Это предотвращает поломку поведения языка.
        ###########################################################################
        PSAvoidAssignmentToAutomaticVariable = @{
            Severity = "Error"
        }

        ###########################################################################
        # 🔥 PSMisleadingBacktick
        # Выявляет случайные обратные апострофы ` в конце строки.
        # Такие символы могут вызвать неожиданные переносы строк.
        ###########################################################################
        PSMisleadingBacktick = @{
            Severity = "Error"
        }

        ###########################################################################
        # 🔥 PSMisleadingPipeRedirect
        # Ловит ошибки, когда конвейер `|` и перенаправление `>` или `>>`
        # используются вместе и могут работать не так, как ожидалось.
        ###########################################################################
        PSMisleadingPipeRedirect = @{
            Severity = "Warning"
        }

        ###########################################################################
        # 🔥 PSPossibleIncorrectComparisonWithNull
        # Проверяет корректность сравнения с $null.
        # Предотвращает ошибку: if ($null -eq $value) ... (неправильно)
        ###########################################################################
        PSPossibleIncorrectComparisonWithNull = @{
            Severity = "Error"
        }

        ###########################################################################
        # 🔥 PSPossibleIncorrectUsageOfAssignmentOperator
        # Ловит путаницу между "=" (присваивание) и "-eq" (сравнение).
        ###########################################################################
        PSPossibleIncorrectUsageOfAssignmentOperator = @{
            Severity = "Error"
        }

        ###########################################################################
        # 🔥 PSReturnCorrectTypes
        # Требует, чтобы функция возвращала значения одного типа из всех веток.
        # Предотвращает неожиданное поведение функций.
        ###########################################################################
        PSReturnCorrectTypes = @{
            Severity = "Warning"
        }

        ###########################################################################
        # 🔥 PSAvoidUsingEmptyCatchBlock
        # Ловит пустые catch-блоки.
        # Предотвращает скрытие ошибок выполнения.
        ###########################################################################
        PSAvoidUsingEmptyCatchBlock = @{
            Severity = "Error"
        }

        ###########################################################################
        # 🔥 PSAvoidUsingInvokeExpression
        # Запрещает Invoke-Expression — опасное выполнение текста как кода.
        ###########################################################################
        PSAvoidUsingInvokeExpression = @{
            Severity = "Error"
        }

        ###########################################################################
        # ⚠ PSAvoidUsingPlainTextForPassword
        # Предупреждает о небезопасном хранении паролей в открытом виде.
        ###########################################################################
        PSAvoidUsingPlainTextForPassword = @{
            Severity = "Warning"
        }

        ###########################################################################
        # ⚠ PSAvoidUsingConvertToSecureStringWithPlainText
        # Проверяет попытки преобразовать открытый пароль в SecureString.
        ###########################################################################
        PSAvoidUsingConvertToSecureStringWithPlainText = @{
            Severity = "Warning"
        }

        ###########################################################################
        # ⚠ PSUseApprovedVerbs
        # Требует использования официальных PowerShell-глаголов (Get, Set, New…)
        # Повышает предсказуемость и переносимость скриптов.
        ###########################################################################
        PSUseApprovedVerbs = @{
            Severity = "Warning"
        }

        ###########################################################################
        # ⚠ PSUseShouldProcessForStateChangingFunctions
        # Требует реализации –WhatIf / –Confirm в функциях,
        # которые модифицируют файлы, систему, окружение.
        ###########################################################################
        PSUseShouldProcessForStateChangingFunctions = @{
            Severity = "Warning"
        }
    }
}
