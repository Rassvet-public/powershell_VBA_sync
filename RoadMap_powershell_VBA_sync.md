–ì–æ—Ç–æ–≤–æ ‚Äî –≤–æ—Ç **–∫—Ä–∞—Ç–∫–∞—è, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ —Ç–æ—á–Ω–∞—è, –±–µ–∑ –≤–æ–¥—ã** –º–∞—Ä—à—Ä—É—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞ —Ç–≤–æ–µ–≥–æ –ø—É—Ç–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ CI/CD GitHub Actions –¥–ª—è PowerShell-–ø—Ä–æ–µ–∫—Ç–∞.
–î–∞—é –≤ **markdown**, –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–æ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –ø—Ä–æ–µ–∫—Ç.

---

# üìò –ú–∞—Ä—à—Ä—É—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞ (Roadmap) –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ CI/CD GitHub Actions

### *–ü—Ä–æ–µ–∫—Ç: Sync-VBA PowerShell CI | PSScriptAnalyzer | UTF-8 BOM | Branch Protection*

---

## 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

* –°–æ–∑–¥–∞–Ω —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π `powershell_VBA_sync`
* –ü—Ä–∏–≤–µ–¥–µ–Ω—ã –≤ –ø–æ—Ä—è–¥–æ–∫ –≤–µ—Ç–∫–∏:

  * `master` ‚Äî —Å—Ç–∞–±–∏–ª—å–Ω–∞—è
  * `dev` ‚Äî —Ä–∞–±–æ—á–∞—è
* –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:

  ```
  git init
  git remote add origin ‚Ä¶
  git config user.name / user.email
  ```

---

## 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ CI

–°–æ–∑–¥–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

```
.github/
   workflows/
       analyze_ps_v5.yml
       check_encoding.yml
   PSScriptAnalyzerRuleSet.psd1
```

---

## 3. –ü–µ—Ä–≤–∞—è –≤–µ—Ä—Å–∏—è workflow (v4)

* –°–æ–∑–¥–∞–Ω YAML –¥–ª—è PSScriptAnalyzer
* –ë—ã–ª–∏ –æ—à–∏–±–∫–∏:

  * —Å—Ç–∞—Ä—ã–π trigger `push: dev`
  * –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–æ –Ω–∞ master
  * –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
  * –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä `-CustomRulePath`

---

## 4. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ triggers

Workflow –æ–±–Ω–æ–≤–ª—ë–Ω:

```
on:
  push:
    branches: [ dev, master ]
  pull_request:
    branches: [ dev, master ]
```

–¢–µ–ø–µ—Ä—å CI –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤–µ–∑–¥–µ, –≥–¥–µ –Ω—É–∂–Ω–æ.

---

## 5. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ PowerShell

–î–æ–±–∞–≤–ª–µ–Ω –∞–Ω–∞–ª–∏–∑ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞:

```
[System.Management.Automation.Language.Parser]::ParseFile()
```

–¢–µ–ø–µ—Ä—å –ª—é–±—ã–µ –º—É—Å–æ—Ä–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ (`dfsd sd e3`) –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –ª–æ–º–∞—é—Ç CI.

---

## 6. –°–æ–∑–¥–∞–Ω–∏–µ RuleSet (–Ω–∞–±–æ—Ä –ê)

–°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª:

```
PSScriptAnalyzerRuleSet.psd1
```

–§–æ—Ä–º–∞—Ç:

* –ö–æ–¥–∏—Ä–æ–≤–∫–∞: **UTF-8 BOM**
* –ö–æ–Ω—Ü—ã —Å—Ç—Ä–æ–∫: **CRLF**

–í RuleSet –≤–∫–ª—é—á–µ–Ω—ã —Ç–æ–ª—å–∫–æ –≤–∞–∂–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞:

* PSAvoidAssignmentToAutomaticVariable
* PSMisleadingBacktick
* PSMisleadingPipeRedirect
* PSPossibleIncorrectComparisonWithNull
* PSPossibleIncorrectUsageOfAssignmentOperator
* PSReturnCorrectTypes
* PSAvoidUsingEmptyCatchBlock
* PSAvoidUsingInvokeExpression
* PSAvoidUsingPlainTextForPassword
* PSAvoidUsingConvertToSecureStringWithPlainText
* PSUseApprovedVerbs
* PSUseShouldProcessForStateChangingFunctions

---

## 7. –°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞–±–æ—á–µ–≥–æ workflow (v5)

–í analyze_ps_v5:

* —É–±—Ä–∞–Ω `-CustomRulePath`
* –¥–æ–±–∞–≤–ª–µ–Ω `-Settings PSScriptAnalyzerRuleSet.psd1`
* –¥–æ–±–∞–≤–ª–µ–Ω —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
* –¥–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ñ–∞–π–ª–∞
* –µ–¥–∏–Ω—ã–π –ª–æ–≥ —Ä–∞–±–æ—Ç—ã

---

## 8. –£–¥–∞–ª–µ–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö workflow

–£–¥–∞–ª—ë–Ω:

```
.github/workflows/analyze_ps_v4.yml
```

—á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è checks.

---

## 9. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ UTF-8 BOM

–°–æ–∑–¥–∞–Ω workflow:

```
check_encoding.yml
```

–û–Ω –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:

* `.ps1` ‚Üí UTF-8 BOM
* `.txt`, `.md`, `.yml` ‚Üí UTF-8 –±–µ–∑ BOM
* `.psd1` ‚Üí UTF-8 BOM

---

## 10. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Branch Protection

–í–∫–ª—é—á–µ–Ω–æ:

* Require PR before merging
* Require status checks to pass
* Required checks:

  * **PSScriptAnalyzer Check v5 / pssa**
  * **UTF-8 BOM Encoding Check / encoding_check**
* Disallow direct push to master
* Linear history

–¢–µ–ø–µ—Ä—å master –∑–∞—â–∏—â—ë–Ω, –æ—à–∏–±–∫–∏ –Ω–µ –ø—Ä–æ—Ö–æ–¥—è—Ç.

---

## 11. –ü—Ä–æ–≤–µ—Ä–∫–∞ pipeline

–¢–µ—Å—Ç–æ–≤—ã–µ –æ—à–∏–±–∫–∏ (–≤—Å—Ç–∞–≤–∫–∞ –º—É—Å–æ—Ä–∞) –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ª–æ–º–∞—é—Ç pipeline ‚Üí PR –∑–∞–ø—Ä–µ—â—ë–Ω.
–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è ‚Äî merge –ø—Ä–æ—Ö–æ–¥–∏—Ç.

---

# ‚úî –ò—Ç–æ–≥–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ CI

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç                       | –°—Ç–∞—Ç—É—Å      |
| ------------------------------- | ----------- |
| PSScriptAnalyzer (RuleSet A)    | ‚úî –†–∞–±–æ—Ç–∞–µ—Ç  |
| –õ–æ–≤–∏—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏     | ‚úî           |
| –õ–æ–≤–∏—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞–Ω—Ç–∏-–ø–∞—Ç—Ç–µ—Ä–Ω—ã | ‚úî           |
| UTF-8 BOM check                 | ‚úî           |
| Triggers –¥–ª—è dev + master       | ‚úî           |
| Branch Protection               | ‚úî –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ |
| –°—Ç–∞—Ä—ã–µ workflow —É–¥–∞–ª–µ–Ω—ã         | ‚úî           |
| –û—à–∏–±–∫–∏ –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ master     | ‚úî           |
| PR pipeline —Å—Ç–∞–±–∏–ª–µ–Ω            | ‚úî           |

---

# üîß –î–æ—Ä–∞–±–æ—Ç–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –ª–æ–≥–∏—á–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–∞–ª—å—à–µ

## 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –≤–µ—Ç–æ–∫ –ø–æ—Å–ª–µ merge

–í–∫–ª—é—á–∞–µ—Ç—Å—è –≤ GitHub Settings.

## 2. Pester-—Ç–µ—Å—Ç—ã PowerShell

–î–æ–±–∞–≤–∏—Ç—å:

```
Invoke-Pester
```

–≤ CI ‚Üí –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å Import-VBA / Export-VBA —Ñ—É–Ω–∫—Ü–∏—é.

## 3. Workflow –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–ª–∏–∑–æ–≤

–ü—Ä–∏ merge –≤ master ‚Üí tag + GitHub Release + –∞—Ä—Ö–∏–≤.

## 4. YAML lint

–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ YAML —Ñ–∞–π–ª–æ–≤:

```
yamllint
```

## 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ JSON/Markdown –ª–∏–Ω—Ç–µ—Ä–æ–º

–ü—Ä–æ–±–ª–µ–º—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±—É–¥—É—Ç –ª–æ–≤–∏—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

## 6. –ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞ PowerShell –ø–æ Warning-–ø—Ä–∞–≤–∏–ª–∞–º (–Ω–µ Error)

–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤—Ç–æ—Ä–æ–π job, —á—Ç–æ–±—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∏—Å—å, –Ω–æ PR –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª—Å—è.

## 7. –ü—Ä–æ–≤–µ—Ä–∫–∞ whitespace/indentation

–ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å—Ç—Ä–æ–≥–∏–π —Å—Ç–∏–ª—å.

---

# üì¶ –ì–æ—Ç–æ–≤—ã–π —Ä–∞–∑–¥–µ–ª –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ ChatGPT

–î–∞ ‚Äî **YAML –∏ RuleSet –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –≤ –ø—Ä–æ–µ–∫—Ç ChatGPT**, —á—Ç–æ–±—ã:

* –º–æ–¥–µ–ª—å –ø–æ–Ω–∏–º–∞–ª–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–≤–æ–µ–≥–æ CI
* –º–æ–≥–ª–∞ —É–ª—É—á—à–∞—Ç—å workflows
* –º–æ–≥–ª–∞ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
* –Ω–µ –æ—à–∏–±–∞–ª–∞—Å—å –≤ –ø—É—Ç—è—Ö –∏ –∏–º–µ–Ω–∞—Ö —Ñ–∞–π–ª–æ–≤

–î–æ–±–∞–≤–ª—è—Ç—å:

```
.github/workflows/analyze_ps_v5.yml
.github/workflows/check_encoding.yml
.github/PSScriptAnalyzerRuleSet.psd1
```

---

–ì–æ—Ç–æ–≤ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏ —Å–æ–±—Ä–∞—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é CI/CD –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å —Ä–µ–ª–∏–∑—ã, —Ç–µ—Å—Ç—ã –∏ –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—é changelog.
